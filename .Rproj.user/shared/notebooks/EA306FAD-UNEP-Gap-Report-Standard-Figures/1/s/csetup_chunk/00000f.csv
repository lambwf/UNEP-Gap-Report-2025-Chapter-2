"0",""
"0","knitr::opts_chunk$set(echo = FALSE)"
"0","options(dplyr.summarise.inform = FALSE)"
"0",""
"0","rm(list = ls())"
"0",""
"0","library(tidyverse)"
"0","library(openxlsx)"
"0","library(countrycode)"
"0","library(ggrepel)"
"0","library(patchwork)"
"0","library(WDI)"
"0","library(grid)"
"0","library(zoo)"
"0","library(ggalluvial)"
"0",""
"0","source(""https://raw.githubusercontent.com/lambwf/Codebase/main/figure_style.R"")"
"0","source(""https://raw.githubusercontent.com/lambwf/Codebase/main/growth_rate.R"")"
"0",""
"0","load(""data/data_edgar.RData"")"
"0","load(""data/data_gcb_luc.RData"")"
"0","load(""data/data_gcb_co2_ffi.RData"")"
"0","load(""data/data_inv_luc.RData"")"
"0",""
"0",""
"0","cc_EU <- read.csv(""https://raw.githubusercontent.com/openclimatedata/countrygroups/main/data/european-union.csv"") %>% "
"0","  select(iso=Code) %>% "
"0","  mutate(EU=""1"")"
"0",""
"0","cc_LDC <- read.csv(""https://raw.githubusercontent.com/openclimatedata/countrygroups/refs/heads/main/data/ldc.csv"") %>% "
"0","  select(iso=Code) %>% "
"0","  mutate(LDC=1)"
"0",""
"0",""
"0","## Get population data from the World Bank"
"0",""
"0","data_wdi_pop <- WDI(country = ""all"",indicator = ""SP.POP.TOTL"",start = 1970,end = 2024,extra=TRUE,language = ""en"") %>%"
"0","  select(iso3c, country, year, SP.POP.TOTL) %>%"
"0","  filter(!is.na(iso3c))"
"0",""
"0","data_wdi_pop$population <- data_wdi_pop$SP.POP.TOTL"
"0","data_wdi_pop$iso <- data_wdi_pop$iso3c"
"0","data_wdi_pop <- data_wdi_pop %>% select(-SP.POP.TOTL,-iso3c)"
"0",""
"0","################################################################# WARNING - using 2023 population data for 2024 as the latter hasn't been released yet !!!!!"
"0","data_wdi_pop <- data_wdi_pop %>% "
"0","  arrange(country,year) %>% "
"0","  group_by(country) %>% "
"0","  fill(population,.direction=""down"") %>% "
"0","  ungroup()"
"0","#################################################################"
"0",""
"0","## prepare references"
"0",""
"0","ref_edgar <- ""EDGARv10 (https://edgar.jrc.ec.europa.eu/report_2025)"""
"0","ref_gcb <- ""GCB 2024 (https://globalcarbonbudget.org/gcb-2024/)"""
"0","ref_lamb <- ""https://lambwf.github.io/UNEP-Gap-Report-2025-Chapter-2/"""
"0","ref_grassi <-  ""Grassi et al. 2024 (https://zenodo.org/records/7190601)"""
"0","ref_wb <- ""World Bank 2025 (https://databank.worldbank.org/source/population-estimates-and-projections)"""
"0","ref_tidyinv <- ""Tidy GHG Inventories (https://lambwf.github.io/Tidy-GHG-Inventories/)"""
"0",""
"0","## GCB projection (Friedlingstein et al. 2024 table 7)"
"0",""
"0","gcb_luc_projection <- 1.2*3.664"
"0",""
"0","## max year"
"0",""
"0","max_year=2024"
"0",""
"0",""
"0","## Calculate high emitters"
"0",""
"0","high_emitters <- data_edgar %>% "
"0","  group_by(iso,country,year) %>% "
"0","  summarise(value=sum(value)) %>% "
"0","  filter(year==max_year) %>% "
"0","  arrange(desc(value)) %>% "
"0","  head(5)"
"0",""
"0","high_emitters <- c(high_emitters$country, ""European Union"", ""World"")"
"0",""
"0",""
"0","## colours"
"0",""
"0","colours_top6 <- c(""Russia"" = ""#ff9055ff"", "
"0","                  ""United States"" = ""#659cccff"","
"0","                  ""China"" = ""#e5b82cff"","
"0","                  ""European Union"" = ""#17becfff"","
"0","                  ""Brazil"" = ""#7dd396ff"","
"0","                  ""Indonesia"" = ""#7dd396ff"","
"0","                  ""India"" = ""#d45087ff"","
"0","                  ""World"" = ""#818181ff"")"
"0",""
"0",""
"0",""
