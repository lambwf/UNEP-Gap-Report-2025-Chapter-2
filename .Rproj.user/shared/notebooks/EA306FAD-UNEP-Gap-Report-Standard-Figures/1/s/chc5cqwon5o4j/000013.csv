"0",""
"0",""
"0","## Aggregate emissions data"
"0",""
"0","data_top6_luc <- data_edgar %>% "
"0","  filter(year>=1990) %>%  "
"0","  group_by(iso,country,year) %>% "
"0","  summarise(ghg=sum(value,na.rm=T)/1e6)"
"0",""
"0",""
"0","## Add LULUCF data"
"0",""
"0","data_luc <- read.xlsx(""sources/not public/LULUCF NGHGI data for UNEP 2024.xlsx"",startRow = 3)"
"0","data_luc <- data_luc %>% "
"0","  filter(LAND.CATEGORY==""LULUCF net"") %>% "
"0","  gather(year,luc,`2000`:`2023`) %>% "
"0","  mutate(year=as.numeric(year)) %>% "
"0","  select(iso=country.code,year,luc) %>% "
"0","  ungroup()"
"0",""
"0","# slot in tidy ghg inventory data"
"0","load(""../Tidy-GHG-Inventories/data/data_crts_v1.2.RData"")"
"0","data_crts <- data_crts %>% "
"0","  filter(sector_lv1==""Land use, land-use change and forestry"") %>% "
"0","  group_by(iso,year) %>% "
"0","  summarise(value=sum(value,na.rm=T)/1e6) %>% "
"0","  group_by(iso) %>% "
"0","  mutate(n=n()) %>% "
"0","  filter(n>=33) %>% "
"0","  select(-n) %>% "
"0","  ungroup()"
"0",""
"0","data_crts <- data_crts %>% "
"0","  spread(.,year,value) %>% "
"0","  gather(.,year,value,-iso) %>% "
"0","  arrange(iso,year) %>% "
"0","  group_by(iso) %>% "
"0","  fill(value, .direction = ""down"") %>% "
"0","  ungroup() %>% "
"0","  mutate(year=as.numeric(year))"
"0",""
"0","data_luc <- left_join(data_luc,data_crts)"
"2","[38;5;232mJoining with `by = join_by(iso, year)`[39m
"
"0","data_luc <- data_luc %>% "
"0","  mutate(luc=ifelse(is.na(value),luc,value))"
"0",""
"0",""
"0","data_top6_luc <- left_join(data_top6_luc,data_luc,by=join_by(iso,year))"
"0","data_top6_luc <- data_top6_luc %>% "
"0","  mutate(ghg_tot = ghg+luc) %>% "
"0","  filter(!is.na(ghg_tot))"
"0",""
"0",""
"0","## Add Europe"
"0",""
"0","data_top6_luc <- data_top6_luc %>% "
"0","  rbind(.,data_top6_luc %>% "
"0","          left_join(.,cc_EU,by=""iso"") %>% "
"0","          filter(!is.na(EU)) %>% "
"0","          group_by(year) %>% "
"0","          summarise(iso=""EU27"",country=""European Union"",ghg=sum(ghg,na.rm=T)))"
"0",""
"0",""
"0",""
"0","## Create sequence in 5 year intervals for plotting dots"
"0",""
"0","year_higlight <- seq(1990, max(data_top6_luc$year), by = 5)"
"0",""
"0","if (!max(data_top6_luc$year) %in% year_higlight) {"
"0","  year_higlight <- c(year_higlight, max(data_top6_luc$year))"
"0","}"
"0",""
"0",""
"0",""
"0","data_top6_luc %>% "
"0","  filter(country %in% high_emitters) %>% "
"0","  ggplot(.,aes(x=year,y=luc,colour=country)) +"
"0","  geom_hline(yintercept=0)+"
"0","  geom_path(size=1,fill=""none"") +"
"0","  "
"0","  geom_point(data=data_top6_luc %>%"
"0","               filter(country %in% high_emitters) %>%"
"0","               filter(year %in% year_higlight),"
"0","             shape=21,fill=""white"") +"
"0","  scale_x_continuous(breaks = c(1990,2000,2010,max(data_top6_luc$year))) +"
"0","  theme_wl() +"
"0","  scale_colour_manual(values=colours_top6)# +"
"2","G2;H2;Warningh in geom_path(size = 1, fill = ""none"") :
  [38;5;232mIgnoring unknown parameters: `fill`[39mg
"
