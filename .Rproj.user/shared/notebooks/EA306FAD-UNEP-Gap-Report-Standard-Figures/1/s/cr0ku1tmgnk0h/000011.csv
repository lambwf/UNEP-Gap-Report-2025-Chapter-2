"0",""
"0","## Load GCB land use change CO2 data (bookkeeping models)"
"0",""
"0","source(""https://raw.githubusercontent.com/lambwf/Codebase/main/load_gcb_countries_v2024.R"")"
"0",""
"0","data_luc_diff <- load_gcb_countries_luc("
"0","  readxl::read_xlsx('sources/National_LandUseChange_Carbon_Emissions_2024v1.0-1.xlsx',range=""A8:GT182"",sheet=2),"
"0","  readxl::read_xlsx('sources/National_LandUseChange_Carbon_Emissions_2024v1.0-1.xlsx',range=""A8:GT182"",sheet=3),"
"0","  readxl::read_xlsx('sources/National_LandUseChange_Carbon_Emissions_2024v1.0-1.xlsx',range=""A8:GT182"",sheet=4),"
"0","  readxl::read_xlsx('sources/National_LandUseChange_Carbon_Emissions_2024v1.0-1.xlsx',range=""A8:GT182"",sheet=5)) %>% "
"0","  filter(country==""Global"") %>% "
"0","  rename(BLUE=blue,`H&N`=hn,OSCAR=oscar,LUCE=luce,`Bookkeeping average`=mean) %>% "
"0","  select(-country,-iso)"
"2","G2;H2;Warnungh: [38;5;232mThere was 1 warning in `mutate()`.[39m
[38;5;232m[36mâ„¹[38;5;232m In argument: `iso = countrycode(country, ""country.name"", ""iso3c"")`.[39m
Caused by warning:
[33m![39m Some values were not matched unambiguously: DISPUTED, EU27, Global, OTHERg
"
"0","# data_luc_diff <- data_luc_diff %>% "
"0","#   add_row(year=2024,`Bookkeeping average`=gcb_luc_projection)"
"0",""
"0",""
"0","## Add the inventory LULUCF and join"
"0",""
"0","data_luc_inv <- read.csv(""sources/not public/timeseries_JRC.csv"") %>% "
"0","  filter(ISO3==""WRD"",Category==""LULUCF"",Version==""V3.0 (NGHGI 2025)"") %>% "
"0","  rename(year=Year,value=CFluxes_yr) %>% "
"0","  group_by(year) %>% "
"0","  summarise(value=sum(value,na.rm=T)/1000) %>% "
"0","  select(year,`Grassi NGHGI (inventories)`=value)"
"0",""
"0",""
"0","data_luc_diff <- data_luc_diff %>% "
"0","  left_join(.,data_luc_inv,by=join_by(year)) %>% "
"0","  gather(.,var,value,-units,-year) %>% "
"0","  mutate(year=as.numeric(year)) %>% "
"0","  filter(year>=1990) %>% "
"0","  select(year,var,value,units) %>% "
"0","  mutate(units=""GtCO2/year"")"
"0",""
"0",""
"0","## Join FAO land use change CO2 data (inventory aligned, 3rd party)"
"0",""
"0","data_fao <- read.csv(""sources/FAO_Emissions_Totals_E_All_Data_NOFLAG.csv"")"
"0","data_fao <- gather(data_fao,year,value,Y1961:Y2050)"
"0","data_fao$year <- gsub(""Y"","""",data_fao$year)"
"0","data_fao <- data_fao %>% "
"0","  select(country=Area,sector=Item,sector_code=Item.Code,gas=Element,units=Unit,source=Source,year,value)"
"0",""
"0","data_fao <- data_fao %>% "
"0","  filter(country==""World"") %>% "
"0","  filter(sector==""LULUCF"") %>% "
"0","  filter(gas==""Emissions (CO2)"") %>% "
"0","  filter(source==""FAO TIER 1"") %>% "
"0","  filter(year>=1990) %>% "
"0","  filter(year!=2030) %>% "
"0","  filter(year!=2050) %>% "
"0","  mutate(year=as.numeric(year)) %>% "
"0","  mutate(value=value/1e6) %>%"
"0","  mutate(var=""FAOSTAT"") %>% "
"0","  mutate(units=""GtCO2/year"") %>% "
"0","  select(year,var,value,units)"
"0",""
"0","data_luc_diff <- data_luc_diff %>% "
"0","  rbind(.,data_fao)"
"0",""
"0",""
"0","## Get minmax of the bookkeeping data"
"0",""
"0","data_luc_minmax <- data_luc_diff %>% "
"0","  filter(grepl(""H&N"",var) | grepl(""BLUE"",var) | grepl(""OSCAR"",var) | grepl(""LUCE"",var)) %>% "
"0","  group_by(year) %>% "
"0","  summarise(min=min(value),max=max(value))"
"0",""
"0",""
"0","## Create sequence in 5 year intervals for plotting dots"
"0",""
"0","year_higlight <- seq(1990, max(data_luc_diff$year), by = 5)"
"0",""
"0","if (!max(data_luc_diff$year) %in% year_higlight) {"
"0","  year_higlight <- c(year_higlight, max(data_luc_diff$year))"
"0","}"
"0",""
"0",""
"0","labels <- data_luc_diff %>% "
"0","  filter(year>=max(data_luc_diff$year)-9) %>% "
"0","  filter(var %in% c(""Bookkeeping average"",""Grassi NGHGI (inventories)"")) %>%"
"0","  group_by(var) %>% "
"0","  summarise(value_end=last(value),value=mean(value)) %>% "
"0","  mutate(year=paste0(max(data_luc_diff$year)-9,""-"",max(data_luc_diff$year))) %>% "
"0","  group_by(year) %>% "
"0","  mutate(difference=first(value)-last(value))"
"0",""
"0",""
"0","data_luc_diff$var <- as.factor(data_luc_diff$var)"
"0","data_luc_diff$var <- fct_relevel(data_luc_diff$var,""Grassi NGHGI (inventories)"",""Bookkeeping average"",""BLUE"",""H&N"",""OSCAR"",""LUCE"",""FAOSTAT"")"
"0",""
"0",""
"0","p1 <- data_luc_diff %>% ggplot(.,aes(x=year,y=value,colour=var)) +"
"0","  geom_ribbon(data=data_luc_minmax,inherit.aes = FALSE,aes(x=year,ymin=min,ymax=max),fill=""#74a6d4ff"",alpha=0.25) +"
"0","  geom_path(size=1,fill=""none"") +"
"0","  geom_hline(yintercept=0,color=""#636363"",size = 0.25) +"
"0","  geom_point(data=data_luc_diff %>% "
"0","               filter(year %in% year_higlight),"
"0","             shape=21,fill=""white"") +"
"0","  theme_wl() +"
"0","  scale_colour_manual(values=c(""#7dd396ff"",""#3a5e91ff"",""#74a6d4ff"",""#74a6d4ff"",""#74a6d4ff"",""#74a6d4ff"",""#4f8455ff"")) +"
"0","  scale_x_continuous(expand = expansion(mult = c(0.05, 0.01)),breaks = c(1990,2000,2010,max(data_luc_diff$year))) +"
"0","  scale_y_continuous(breaks =c(-4,-2,0,2,4,6,8)) +"
"0","  theme(axis.title = element_blank(),"
"0","        legend.position = ""none"") +"
"0","  labs(title=""Differences in net land use change (LULUCF) estimates"","
"0","       subtitle=bquote(paste(""GtCO""[2], ""/year"")),"
"0","       caption=""âŒ‚ UNEP Emissions Gap Report 2025    âŒ‚ Data: GCB 2024, FAO 2024, Grassi et al. 2025  \nâŒ‚ Note: bookkeeping and inventory estimates differ due to alternative system boundary definitions, see Grassi et al. 2023 ESSD"")"
"2","G2;H2;Warnungh: [38;5;232mUsing `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
[36mâ„¹[38;5;232m Please use `linewidth` instead.
[90mThis warning is displayed once every 8 hours.[38;5;232m
[90mCall `lifecycle::last_lifecycle_]8;;ide:run:warnings()warnings()]8;;` to see where this warning was generated.[38;5;232m[39mg
"
"2","G2;H2;Warningh in geom_path(size = 1, fill = ""none"") :
  [38;5;232mIgnoring unknown parameters: `fill`[39mg
"
"0","p2 <- data_luc_diff %>% "
"0","  filter(year==max(data_luc_diff$year)) %>% "
"0","  add_row(year=2023,var=""FAOSTAT"",value=1.1451024) %>% "
"0","  ggplot(.) +"
"0","  geom_segment(aes(x=3.9,xend=3.9,y=labels$value_end[1],yend=labels$value_end[2]),color=""#636363"",size = 0.25) +"
"0","  geom_segment(aes(x=3.8,xend=3.9,y=labels$value_end[1],yend=labels$value_end[1]),color=""#636363"",size = 0.25) +"
"0","  geom_segment(aes(x=3.8,xend=3.9,y=labels$value_end[2],yend=labels$value_end[2]),color=""#636363"",size = 0.25) +"
"0","  annotate(""text"",x=4,y=sum(labels$value_end),label=str_wrap(paste0(""10 year avg. difference: "",signif(labels$difference,2), "" Gt""),20),hjust=0,vjust=1,size=3.5,colour=""#636363"") +"
"0","  "
"0","  geom_text_repel(aes(x = 1, y = value, label = str_wrap(var, 20), colour = var),"
"0","                  hjust = 0,"
"0","                  nudge_x = 0.4,"
"0","                  nudge_y = 0.75,"
"0","                  direction = ""y"","
"0","                  point.size = NA,"
"0","                  size = 3.5,"
"0","                  show.legend = FALSE,"
"0","                  min.segment.length = 0,"
"0","                  box.padding = 0.2,"
"0","                  force = 0.1,"
"0","                  segment.size = 0.25"
"0","  ) +"
"0","  "
"0","  scale_colour_manual(values=c(""Grassi NGHGI (inventories)""=""#7dd396ff"","
"0","                               ""Bookkeeping average"" = ""#3a5e91ff"","
"0","                               ""OSCAR""= ""#74a6d4ff"","
"0","                               ""LUCE"" = ""#74a6d4ff"","
"0","                               ""H&N"" = ""#74a6d4ff"","
"0","                               ""BLUE"" = ""#74a6d4ff"","
"0","                               ""FAOSTAT"" = ""#4f8455ff"")) +"
"0","  scale_y_continuous(limits = layer_scales(p1)$y$range$range) +"
"0","  scale_x_continuous(expand = expansion(mult = c(0, 0.01)),limits=c(1,6)) +"
"0","  theme_wl_empty() +"
"0","  theme(legend.position=""none"")"
"0",""
"0",""
"0","plot <- p1 + plot_spacer() + p2 + plot_layout(widths = c(4.5,-0.3,2.9))"
"0","plot"
