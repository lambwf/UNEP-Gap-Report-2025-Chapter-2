"0",""
"0","## Aggregate emissions data"
"0",""
"0","data_uncertainties <- data_edgar %>%"
"0","  group_by(year,gas) %>% "
"0","  summarise(value=sum(value,na.rm=T)/1e9)"
"0",""
"0","data_uncertainties_luc <- data_gcb_luc %>% "
"0","  filter(country==""Global"") %>% "
"0","  mutate(value=value/1e9)"
"0",""
"0","# Add the GCB projection and join"
"0",""
"0","data_uncertainties_luc <- data_uncertainties_luc %>%"
"0","  add_row(year=2024,value=gcb_luc_projection)"
"0",""
"0","data_uncertainties_luc <- data_uncertainties_luc %>% "
"0","  mutate(gas=""CO2 LULUCF"") %>% "
"0","  select(-iso,-country)"
"0",""
"0","data_uncertainties <- rbind(data_uncertainties,data_uncertainties_luc) %>% "
"0","  filter(year==max(data_uncertainties$year))"
"0",""
"0",""
"0","## Calculate uncertainties"
"0",""
"0","data_uncertainties <- data_uncertainties %>% "
"0","  left_join(.,data.frame(gas=c(""CO2 Fossil"",""CO2 LULUCF"",""CH4"",""N2O"",""F-gases""),"
"0","                         uncertainty=c(0.08,0.7,0.3,0.6,0.3)),by=join_by(gas)) %>%"
"0","  mutate(uncertainty_abs=value*uncertainty)"
"0",""
"0",""
"0","## Aggregate total uncertainty"
"0",""
"0","data_uncertainties_total <- data_uncertainties %>% "
"0","  mutate(uncertainty_abs=uncertainty_abs^2) %>% "
"0","  group_by(year) %>% "
"0","  summarise(value=sum(value,na.rm=TRUE),"
"0","            uncertainty_abs=sqrt(sum(uncertainty_abs,na.rm=TRUE))) %>% "
"0","  mutate(gas=""Total"")"
"0",""
"0",""
"0","data_uncertainties <- data_uncertainties %>% "
"0","  bind_rows(.,data_uncertainties_total)"
"0",""
"0",""
"0","## Generate labels"
"0",""
"0","data_uncertainties <- data_uncertainties %>% "
"0","  mutate(label=ifelse(gas %in% c(""CO2 Fossil"",""Total""),"
"0","                      paste0(signif(value,3),"" ± "",signif(uncertainty_abs,2)),"
"0","                      paste0(signif(value,2),"" ± "",signif(uncertainty_abs,2))))"
"0",""
"0",""
"0","## Arrange levels"
"0",""
"0","data_uncertainties$gas <- as.factor(data_uncertainties$gas)"
"0","data_uncertainties$gas <- fct_relevel(data_uncertainties$gas,"
"0","                                      ""F-gases"",""N2O"",""CH4"",""CO2 LULUCF"","
"0","                                      ""CO2 Fossil"",""Total"")"
"0",""
"0","## Plot"
"0",""
"0","plot <- data_uncertainties %>% ggplot(.,aes(x=value,y=gas,fill=gas,label=label)) +"
"0","  geom_col(color=""#252525"",linewidth=0.25) +"
"0","  geom_errorbarh(aes(xmin=value-uncertainty_abs,xmax=value+uncertainty_abs),"
"0","                 height=0.4,colour=""#525252"") +"
"0","  geom_text(aes(x=value+uncertainty_abs+1),hjust=0,colour=""#636363"") +"
"0","  theme_wl() +"
"0","  scale_fill_manual(values=colours_gases) +"
"0","  scale_x_continuous(breaks=c(0,10,20,30,40,50,60),expand = expansion(mult = c(0.05, 0.15))) +"
"0","  theme(legend.position = ""none"","
"0","        axis.title = element_blank(),"
"0","        panel.grid.major.y = element_blank(),"
"0","        plot.title = element_text(margin=margin(t=15))) +"
"0","  labs(title=""Total net greenhouse gas emissions and their uncertainties"","
"0","       subtitle=bquote(paste(""GtCO""[2], ""e in 2024"")),"
"0","       caption=""⌂ UNEP Emissions Gap Report 2025    ⌂ Data: EDGAR v10, GCB 2024  \n⌂ Note: GWP100 AR6; net land use change (LULUCF) emissions based on bookkeeping conventions"")"
"0","plot "
