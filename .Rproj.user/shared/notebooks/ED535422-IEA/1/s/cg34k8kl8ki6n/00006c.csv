"0","
data <- left_join(data_iea,data_co2 %>% select(-flow))
"
"2","Joining with `by = join_by(country, year, join)`"
"0","data <- left_join(data,order)"
"2","Joining with `by = join_by(join)`"
"0","data <- left_join(data,countries)"
"2","Joining with `by = join_by(country)`"
"0","############################"
"0","# calculate elec heat of each country and sector"
"0","# divide by total final consumption"
"0","# multiply it by the power sector emissions of each country"
"0",""
"0","data <- data %>% "
"0","  filter(keep==1) %>% "
"0","  arrange(country,order) %>% "
"0","  select(-keep)"
"0",""
"0","data <- data %>% "
"0","  rowwise() %>%"
"0","  mutate(elecheat = sum(electricity, heat, na.rm = TRUE)) %>%"
"0","  ungroup()"
"0",""
"0","tfec <- data %>% "
"0","  filter(join %in% c(""Total final consumption"",""Energy industry own use"",""Losses"")) %>%"
"0","  spread(.,join,elecheat) %>% "
"0","  select(country,`Total final consumption`,`Energy industry own use`,`Losses`) %>%"
"0","  group_by(country) %>%"
"0","  mutate(across(everything(), ~na.locf(., na.rm = FALSE))) %>%"
"0","  mutate(across(everything(), ~na.locf(., na.rm = FALSE,fromLast = TRUE))) %>%"
"0","  ungroup() %>% "
"0","  distinct()"
"0",""
"0","data <- left_join(data,tfec)"
"2","Joining with `by = join_by(country)`"
"0","data <- data %>% "
"0","  left_join(.,data_co2 %>% filter(join==""Electricity and heat production"") %>% select(country,co2_elecheat=co2)) %>% "
"0","  left_join(.,data_co2 %>% filter(join==""Energy industry own use"") %>% select(country,co2_eneown=co2)) %>% "
"0","  left_join(.,data_co2 %>% filter(join==""CO2 emissions from fuel combustion"") %>% select(country,co2_total=co2))"
"2","Joining with `by = join_by(country)`"
"2","Joining with `by = join_by(country)`"
"2","Joining with `by = join_by(country)`"
