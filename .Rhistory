View(data_comparison)
## Aggregate emissions data
data_total <- data_edgar %>%
group_by(year,gas) %>%
summarise(value=sum(value,na.rm=T)/1e9)
data_total_luc <- data_gcb_luc %>%
filter(country=="Global") %>%
mutate(value=value/1e9)
# Add the GCB projection and join
data_total_luc <- data_total_luc %>%
add_row(year=2024,value=gcb_luc_projection)
data_total_luc <- data_total_luc %>%
mutate(gas="CO2 LULUCF") %>%
select(-iso,-country)
data_total <- rbind(data_total,data_total_luc) %>%
filter(year>=1990)
# Calculate abs change
data_total <- data_total %>%
filter(year>=max(data_total$year)-1) %>%
arrange(gas,year) %>%
group_by(gas) %>%
mutate(abs_change=last(value)-first(value),
rel_change=growth_rate(year,value)$rate*100) %>%
mutate(abs_change=round(abs_change,2))
# Calculate share of total change
data_total <- data_total %>%
filter(year==2024) %>%
mutate(share_abs_change=abs_change/sum(data_total$abs_change))
## Aggregate emissions
data_total <- data_edgar %>%
group_by(year,gas) %>%
summarise(value=sum(value,na.rm=T)/1e9)
data_total_luc <- data_gcb_luc %>%
filter(country=="Global") %>%
mutate(value=value/1e9)
# Add the GCB projection and join
data_total_luc <- data_total_luc %>%
add_row(year=2024,value=gcb_luc_projection)
data_total_luc <- data_total_luc %>%
mutate(gas="CO2 LULUCF") %>%
select(-iso,-country)
data_total <- rbind(data_total,data_total_luc) %>%
filter(year>=1990)
# aggregate
data_total <- data_total %>%
group_by(year) %>%
summarise(value=sum(value,na.rm=TRUE))
# calculate change per decade
data_total <- data_total %>%
mutate(cut=ifelse(year>=2010 & year <=2019,"2010-2019",NA)) %>%
mutate(cut=ifelse(year>=2000 & year <=2009,"2000-2009",cut)) %>%
mutate(cut=ifelse(year>=1990 & year <=1999,"1990-1999",cut)) %>%
mutate(cut=ifelse(year %in% c(2022,2023),"2022-2023",cut))
data_total <- data_total %>%
group_by(cut) %>%
mutate(change=growth_rate(year,value)$rate) %>%
mutate(change=change*100) %>%
mutate(change=round(change,1))
View(data_total)
data_total <- data_edgar %>%
group_by(year,gas) %>%
summarise(value=sum(value,na.rm=T)/1e9)
data_total_luc <- data_gcb_luc %>%
filter(country=="Global") %>%
mutate(value=value/1e9)
# Add the GCB projection and join
data_total_luc <- data_total_luc %>%
add_row(year=2024,value=gcb_luc_projection)
data_total_luc <- data_total_luc %>%
mutate(gas="CO2 LULUCF") %>%
select(-iso,-country)
data_total <- rbind(data_total,data_total_luc) %>%
filter(year>=1990)
# aggregate
data_total <- data_total %>%
group_by(year) %>%
summarise(value=sum(value,na.rm=TRUE))
data_total <- data_edgar %>%
group_by(year,gas) %>%
summarise(value=sum(value,na.rm=T)/1e9)
data_total_luc <- data_gcb_luc %>%
filter(country=="Global") %>%
mutate(value=value/1e9)
# Add the GCB projection and join
data_total_luc <- data_total_luc %>%
add_row(year=2024,value=gcb_luc_projection)
data_total_luc <- data_total_luc %>%
mutate(gas="CO2 LULUCF") %>%
select(-iso,-country)
# data_total <- rbind(data_total,data_total_luc) %>%
#   filter(year>=1990)
# aggregate
data_total <- data_total %>%
group_by(year) %>%
summarise(value=sum(value,na.rm=TRUE))
data_total <- data_total %>%
mutate(cut=ifelse(year>=2010 & year <=2019,"2010-2019",NA)) %>%
mutate(cut=ifelse(year>=2000 & year <=2009,"2000-2009",cut)) %>%
mutate(cut=ifelse(year>=1990 & year <=1999,"1990-1999",cut)) %>%
mutate(cut=ifelse(year>=1980 & year <=1989,"1980-1989",cut)) %>%
mutate(cut=ifelse(year>=1970 & year <=1979,"1970-1979",cut)) %>%
mutate(cut=ifelse(year %in% c(2022,2023),"2022-2023",cut))
data_total <- data_total %>%
group_by(cut) %>%
mutate(change=growth_rate(year,value)$rate) %>%
mutate(change=change*100) %>%
mutate(change=round(change,1))
knitr::opts_chunk$set(echo = FALSE)
options(dplyr.summarise.inform = FALSE)
rm(list = ls())
library(tidyverse)
library(openxlsx)
library(countrycode)
library(ggrepel)
library(patchwork)
library(WDI)
library(grid)
library(zoo)
library(ggalluvial)
source("https://raw.githubusercontent.com/lambwf/Codebase/main/figure_style.R")
source("https://raw.githubusercontent.com/lambwf/Codebase/main/growth_rate.R")
load("data/data_edgar.RData")
load("data/data_gcb_luc.RData")
load("data/data_gcb_co2_ffi.RData")
load("data/data_inv_luc.RData")
cc_EU <- read.csv("https://raw.githubusercontent.com/openclimatedata/countrygroups/main/data/european-union.csv") %>%
select(iso=Code) %>%
mutate(EU="1")
cc_LDC <- read.csv("https://raw.githubusercontent.com/openclimatedata/countrygroups/refs/heads/main/data/ldc.csv") %>%
select(iso=Code) %>%
mutate(LDC=1)
cc_G20<- read.csv("https://raw.githubusercontent.com/openclimatedata/countrygroups/refs/heads/main/data/g20.csv") %>%
select(iso=Code) %>%
add_row(iso="EU27") %>%
mutate(G20=1)
## Get population data from the World Bank
data_wdi_pop <- WDI(country = "all",indicator = "SP.POP.TOTL",start = 1970,end = 2024,extra=TRUE,language = "en") %>%
select(iso3c, country, year, SP.POP.TOTL) %>%
filter(!is.na(iso3c))
data_wdi_pop$population <- data_wdi_pop$SP.POP.TOTL
data_wdi_pop$iso <- data_wdi_pop$iso3c
data_wdi_pop <- data_wdi_pop %>% select(-SP.POP.TOTL,-iso3c)
################################################################# WARNING - using 2023 population data for 2024 as the latter hasn't been released yet !!!!!
data_wdi_pop <- data_wdi_pop %>%
arrange(country,year) %>%
group_by(country) %>%
fill(population,.direction="down") %>%
ungroup()
#################################################################
## prepare references
ref_edgar <- "EDGARv10 (https://edgar.jrc.ec.europa.eu/report_2025)"
ref_gcb <- "GCB 2024 (https://globalcarbonbudget.org/gcb-2024/)"
ref_lamb <- "https://lambwf.github.io/UNEP-Gap-Report-2025-Chapter-2/"
ref_grassi <-  "Grassi et al. 2024 (https://zenodo.org/records/7190601)"
ref_wb <- "World Bank 2025 (https://databank.worldbank.org/source/population-estimates-and-projections)"
ref_tidyinv <- "Tidy GHG Inventories (https://lambwf.github.io/Tidy-GHG-Inventories/)"
## GCB projection (Friedlingstein et al. 2024 table 7)
gcb_luc_projection <- 1.2*3.664
## max year
max_year=2024
## Calculate high emitters
high_emitters <- data_edgar %>%
group_by(iso,country,year) %>%
summarise(value=sum(value)) %>%
filter(year==max_year) %>%
arrange(desc(value)) %>%
head(5)
high_emitters <- c(high_emitters$country, "European Union", "World")
## colours
colours_top6 <- c("Russia" = "#ff9055ff",
"United States" = "#659cccff",
"China" = "#e5b82cff",
"European Union" = "#17becfff",
"Brazil" = "#7dd396ff",
"Indonesia" = "#7dd396ff",
"India" = "#d45087ff",
"World" = "#818181ff")
## adjust country names
data_edgar$country <- gsub("Turkey","Türkiye",data_edgar$country)
data_gcb_co2_ffi$country <- gsub("Turkey","Türkiye",data_gcb_co2_ffi$country)
data_gcb_luc$country <- gsub("Turkey","Türkiye",data_gcb_luc$country)
data_inv_luc$country <- gsub("Turkey","Türkiye",data_inv_luc$country)
data_wdi_pop$country <- gsub("Turkey","Türkiye",data_wdi_pop$country)
data_edgar$country <- gsub("Turkey","Türkiye",data_edgar$country)
data_gcb_co2_ffi$country <- gsub("Turkey","Türkiye",data_gcb_co2_ffi$country)
data_gcb_luc$country <- gsub("Turkey","Türkiye",data_gcb_luc$country)
data_wdi_pop$country <- gsub("Turkey","Türkiye",data_wdi_pop$country)
View(data_edgar)
## Aggregate emissions
data_countries <- data_edgar %>%
group_by(iso,country,sector_lv2,sector_lv2_order,year) %>%
summarise(value=sum(value,na.rm=T)/1e6) %>%
filter(year>=1990) %>%
mutate(gapfilled="no")
# Gather LUC inventory data
data_countries_luc <- data_inv_luc %>%
spread(.,year,value) %>%
mutate(`2024`=NA)
data_countries_luc <- data_countries_luc %>%
gather(.,year,value,-iso,-sector_lv1,-sector_lv2,-sector_lv2_order) %>%
arrange(iso,year) %>%
mutate(gapfilled=ifelse(is.na(value),"yes","no")) %>%
mutate(year=as.numeric(year))
# Project 2024 LUC (but hatch this is in the main plot)
data_countries_luc <- data_countries_luc %>%
group_by(iso) %>%
fill(value, .direction = "down") %>%
select(-sector_lv1)
# Project 1990-2000 LUC (but hatch this is in the main plot)
data_countries_luc <- data_countries_luc %>%
group_by(iso) %>%
fill(value, .direction = "up")
# Join to GHG emissions data
data_countries <- rbind(data_countries,data_countries_luc)
data_countries <- data_countries %>%
ungroup() %>%
arrange(iso,year) %>%
mutate(country=na.locf(country))
## Add Europe
data_countries_eu <- data_countries %>%
left_join(.,cc_EU,by="iso") %>%
filter(!is.na(EU)) %>%
mutate(iso="EU27",country="European Union") %>%
group_by(iso,country,sector_lv2,sector_lv2_order,year) %>%
summarise(value=sum(value)) %>%
mutate(gapfilled=ifelse(sector_lv2=="Land use change (LULUCF)" & year==2024,"yes","no"))
data_countries <- rbind(data_countries,data_countries_eu)
data_countries$sector_lv2 <- as.factor(data_countries$sector_lv2)
data_countries$sector_lv2 <- fct_reorder(data_countries$sector_lv2,data_countries$sector_lv2_order)
data_countries <- data_countries %>%
arrange(iso,country,sector_lv2,year)
##
plot_country <- function(countries,data_countries) {
data_countries <- data_countries %>%
filter(country==countries)
totals <- data_countries %>%
filter(sector_lv2!="Land use change (LULUCF)") %>%
group_by(year) %>%
summarise(value=sum(value,na.rm=T)) %>%
filter(year >= max(data_countries$year)-3) %>%
ungroup() %>%
mutate(change=growth_rate(year,value)$rate) %>%
mutate(change=change*100) %>%
mutate(change=signif(change,2)) %>%
mutate(change=ifelse(change>0,paste0("+",change,"%"),paste0("-",abs(change),"%"))) %>%
mutate(value=signif(value,3)) %>%
filter(year==max(data_countries$year))
data_countries <- data_countries %>%
# mutate(pattern_override = ifelse(sector_lv2 == "Land use change (LULUCF)" & year == 2024,"stripe","none")) %>%
mutate(pattern_override = ifelse(gapfilled=="yes","stripe","none"))
main_plot <- ggplot() +
ggpattern::geom_col_pattern(
data = data_countries,
aes(x = year, y = value, fill = sector_lv2,pattern = pattern_override),
pattern_fill = "#525252",
pattern_density = 0.3,
pattern_spacing = 0.02,
pattern_angle = 45,
pattern_size = 0.15,
color = NA,       # no stroke here
linewidth = 0,
width = 1
) +
geom_col(
data = data_countries,
aes(x = year, y = value,fill = sector_lv2),
#fill = NA,             # no fill
color = "#252525",     # stroke only
linewidth = 0.25,
width = 1,
alpha=0
) +
# annotation_custom(grob = textGrob(paste0("Emissions in ",paste0(max(data_countries$year)),": ",totals$value),
#                                 x = unit(1.0425, "npc"), y = unit(0.02, "npc"),hjust = 0, vjust = -1,
#                                 gp = gpar(col = "#636363", fontsize = 10)),
#                 xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
# annotation_custom(grob = textGrob(paste0("Change since ",max(data_countries$year)-3,": ",totals$change),
#                                   x = unit(1.0425, "npc"), y = unit(-0.04, "npc"),hjust = 0, vjust = -1,
#                                   gp = gpar(col = "#636363", fontsize = 10)),
#                   xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
coord_cartesian(clip = "off") +
theme_wl_bar_trend() +
scale_fill_manual(values=c(colours_9_sectors)) +
ggpattern::scale_pattern_manual(values = c("none" = "none", "stripe" = "stripe")) +
#scale_y_continuous(breaks=c(0,20,40,60),limits=c(0,70)) +
scale_x_continuous(breaks=c(1990,2000,2010,2020,max(data_countries$year)),
expand = expansion(mult = c(0.05, 0.01))) +
theme(axis.title = element_blank(),
legend.position = "none") +
labs(title=countries,
subtitle=bquote(paste("MtCO"[2], "e/year")),
caption="⌂ UNEP Emissions Gap Report 2025    ⌂ Data: EDGAR v10, Grassi et al. 2025  \n⌂ Note: GWP100 AR6; net land use change (LULUCF) emissions based on inventories. \n⌂ Note: Hatched land use change estimates indicate projections where estimates are not yet available.") +
guides(pattern = "none")
legend_plot <- ggplot(data_countries, aes(x = year, y = value, fill = sector_lv2)) +
geom_col(color = "#252525",linewidth = 0.25) +
scale_fill_manual(values = colours_9_sectors) +
theme_void() +
theme(legend.position = "right",
legend.title = element_blank()) +
guides(fill = guide_legend(title = NULL))
legend <- cowplot::get_legend(legend_plot)
final_plot <- main_plot + plot_spacer() + wrap_elements(legend) +
plot_layout(widths = c(3,0.001 ,1))
return(final_plot)
}
plot_country("Brazil",data_countries)
## Filter to G20 countries
countries <- data_countries %>%
select(iso,country) %>%
distinct() %>%
left_join(.,read.csv("https://raw.githubusercontent.com/openclimatedata/countrygroups/main/data/g20.csv") %>%
select(iso=Code) %>%
mutate(G20="1")) %>%
filter(G20==1)
countries <- c(countries$country,"European Union")
for (i in 1:length(countries)){
plot <- plot_country(countries[i],data_countries)
ggsave(plot,filename = paste0("UNEP-EGR-2025-",countries[i],"-atrend.png"),
path = "results/standard/countries/",device = "png",height = 4,width=8,dpi=300)
ggsave(plot,filename = paste0("UNEP-EGR-2025-",countries[i],"-atrend.pdf"),
path = "results/standard/countries/",device = cairo_pdf,height = 4,width=8)
ggsave(plot,filename = paste0("UNEP-EGR-2025-",countries[i],"-atrend.svg"),
path = "results/standard/countries/",device = 'svg',height = 4,width=8)
}
## Save data
wb <- createWorkbook()
addWorksheet(wb,"info")
addWorksheet(wb,"data")
info = data.frame(a=c("Author","Contact","Data sources","See also"),
b=c("William F. Lamb",
"william.lamb@pik-potsdam.de",
"EDGARv9 (https://edgar.jrc.ec.europa.eu/report_2024); Grassi et al. 2025 (https://forest-observatory.ec.europa.eu/carbon)",
"https://lambwf.github.io/UNEP-Gap-Report-2024-Chapter-2/"))
writeData(wb, sheet = "info",info,colNames = F, rowNames = F)
writeData(wb, sheet = "data",data_countries %>% select(-sector_lv2_order) %>% mutate(units="MtCO2e/year (GWP100 AR6)"),colNames = T, rowNames = F)
saveWorkbook(wb,paste0("results/standard/countries/UNEP-EGR-2025-country-trend.xlsx"),overwrite=T)
## Aggregate emissions
data_countries_change <- data_edgar %>%
group_by(iso,country,sector_lv2,year) %>%
summarise(value=sum(value,na.rm=T)/1e6)
# ## Add land use change emissions
#
# data_countries_luc <- read.xlsx('sources/not public/LULUCF NGHGI data for UNEP 2024.xlsx',startRow = 3) %>%
#   rename(category=LAND.CATEGORY,country=UNFCCC.country,iso=country.code) %>%
#   filter(category=="LULUCF net")
#
# data_countries_luc <- gather(data_countries_luc,year,`Land use change (LULUCF)`,`2000`:`2023`) %>%
#   mutate(year=as.numeric(year)) %>%
#   filter(!is.na(iso)) %>%
#   select(iso,year,`Land use change (LULUCF)`)
#
# data_countries_change <- data_countries_change %>%
#   spread(.,sector_lv2,value) %>%
#   left_join(.,data_countries_luc,by=join_by(iso,year)) %>%
#   gather(.,sector_lv2,value,-iso,-country,-year)
## Add Europe
data_countries_eu <- data_countries_change %>%
left_join(.,cc_EU,by="iso") %>%
filter(!is.na(EU)) %>%
mutate(iso="EU27",country="European Union") %>%
group_by(iso,country,sector_lv2,year) %>%
summarise(value=sum(value))
data_countries_change <- rbind(data_countries_change,data_countries_eu)
countries <- "United Kingdom"; t=1
## Plot
plot_country_change <- function(countries,t,data_countries_change) {
## Filter
data_countries_change <- data_countries_change %>%
filter(country==countries) %>%
filter(year %in% c(max(data_countries_change$year),max(data_countries_change$year)-t))
## Calculate changes and rank
data_countries_change <- data_countries_change %>%
group_by(sector_lv2) %>%
mutate(change_abs=last(value)-first(value),
change_rel=change_abs/first(value))
# Re-arrange order of sectors so that net additions come first, net reductions last
data_countries_change_order <- data_countries_change %>%
ungroup() %>%
filter(year==max(data_countries_change$year)) %>%
arrange(desc(change_abs)) %>%
mutate(order=row_number()) %>%
select(sector_lv2,order)
data_countries_change <- left_join(data_countries_change,data_countries_change_order,by=join_by(sector_lv2)) %>%
arrange(order,year)
## Get totals
data_countries_change_tot <- data_countries_change %>%
group_by(year) %>%
summarise(value=sum(value,na.rm=T)) %>%
mutate(label=paste0("Emissions in ",year,": ",signif(value,3)))
## Arrange data for waterfall
data_countries_change <- data_countries_change  %>%
ungroup() %>%
filter(year==max(data_countries_change$year)-t) %>%
add_row(order=0,change_abs=data_countries_change_tot$value[1]) %>%
arrange(order) %>%
ungroup() %>%
mutate(end = cumsum(change_abs),
start = c(0, head(end, -1))) %>%
filter(order!=0)
## Arrange levels, add labels
data_countries_change$sector_lv2 <- gsub("\\| ","",data_countries_change$sector_lv2)
data_countries_change$sector_lv2 <- as.factor(data_countries_change$sector_lv2)
data_countries_change$sector_lv2 <- fct_reorder(data_countries_change$sector_lv2,data_countries_change$order)
colours_custom <- c(
"Energy Power" = "#17becfff",
"Energy Industry" = "#3a5e91ff",
"Energy Transport" = "#5185b5ff",
"Energy Buildings & other" = "#74a6d4ff",
"Energy Fuel production" = "#ff9055ff",
"Industrial processes" = "#e5b82cff",
"Agriculture" = "#4f8455ff",
"Land use change (LULUCF)" = "#7dd396ff",
"Waste" = "#818181ff")
data_countries_change <- data_countries_change %>%
mutate(labels=signif(change_abs,3)) %>%
mutate(labels=ifelse(labels>0,paste0("+",labels),labels))
## Plot
p1 <- data_countries_change %>%
ggplot(.,aes(fill = sector_lv2)) +
geom_rect(aes(x = sector_lv2,xmin = order - 0.2, xmax = order + 0.2, ymin = end, ymax = start),
color="#252525",linewidth=0.25) +
geom_segment(data=data_countries_change %>% filter(order!=max(data_countries_change$order)),
aes(x = order + 0.2, xend = order + 0.8,y = end, yend = end),
color = "#252525",linewidth=0.25) +
# geom_text(aes(x=sector_lv2,y=ifelse(change_abs>0,end+100,end+100-change_abs),label=labels),
#           color="#636363",
#           size=3.5) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10),expand = expansion(mult = c(0.05, 0.05))) +
scale_y_continuous(breaks=data_countries_change_tot$value) +
scale_fill_manual(values=colours_custom) +
theme_wl() +
theme(legend.position="none",
axis.title = element_blank(),
panel.grid.major.x = element_blank(),
axis.text.x = element_text(vjust = 1),
plot.title = element_text(margin=margin(t=15)),
axis.text.y = element_blank(),
axis.ticks.y = element_blank()) +
# panel.grid.major.y = element_blank(),
# axis.ticks.y = element_blank(),
# axis.line.y = element_blank()) +
labs(title=countries,
subtitle=bquote(paste("Change in recent emissions (MtCO"[2], "e)")),
caption="⌂ UNEP Emissions Gap Report 2025    ⌂ Data: EDGAR v10 \n⌂ Note: GWP100 AR6") +
coord_cartesian(clip = "off")
y_range_scaling <- layer_scales(p1)$y$range$range
y_range_scaling <- diff(y_range_scaling) * 0.08
p1 <- p1 +
geom_text(aes(x=sector_lv2,y=ifelse(change_abs>0,end+y_range_scaling,end+y_range_scaling-change_abs),label=labels),
color="#636363",
size=3.5)
y_range_scaling_2 <- layer_scales(p1)$y$range$range
y_range_expanded <- y_range_scaling_2 + c(-0.001 * diff(y_range_scaling_2),0.001 * diff(y_range_scaling_2))
p2 <- data_countries_change_tot %>%
filter(year==data_countries_change_tot$year[2]) %>%
ggplot(.,aes(x=1.5,y=value,label=str_wrap(label,15))) +
geom_text(size=3.5,colour="#636363",hjust=0) +
geom_segment(aes(x = 1.4, xend = 1, yend = value),
arrow = arrow(length = unit(0.2, "cm")),
colour = "#636363") +
scale_y_continuous(limits = y_range_expanded) +
scale_x_continuous(limits = c(1,4.5),expand = expansion(mult = c(0, 0.05))) +
theme_wl_empty() +
coord_cartesian(clip = "off")
p3 <- data_countries_change_tot %>%
filter(year==data_countries_change_tot$year[1]) %>%
ggplot(.,aes(x=4,y=value,label=str_wrap(label,15))) +
geom_text(size=3.5,colour="#636363",hjust=1) +
geom_segment(aes(x = 4.1, xend = 4.5, yend = value),
arrow = arrow(length = unit(0.2, "cm")),
colour = "#636363") +
scale_y_continuous(limits = y_range_expanded) +
scale_x_continuous(limits = c(1,4.5),expand = expansion(mult = c(0.05, 0))) +
theme_wl_empty() +
coord_cartesian(clip = "off")
plot <- plot_spacer() + p3 + plot_spacer() + p1 + plot_spacer() + p2 + plot_layout(widths=c(-0.26,1,-0.26,6,-0.26,1))
plot
return(plot)
}
plot_country_change("European Union",1,data_countries_change)
## Filter to G20 countries
countries <- data_countries_change %>%
select(iso,country) %>%
distinct() %>%
left_join(.,read.csv("https://raw.githubusercontent.com/openclimatedata/countrygroups/main/data/g20.csv") %>%
select(iso=Code) %>%
mutate(G20="1")) %>%
filter(G20==1)
countries <- c(countries$country,"European Union")
for (i in 1:length(countries)){
plot <- plot_country_change(countries[i],1,data_countries_change)
ggsave(plot,filename = paste0("UNEP-EGR-2025-",countries[i],"-change.png"),
path = "results/standard/countries/",device = "png",height = 4,width=8,dpi=300)
ggsave(plot,filename = paste0("UNEP-EGR-2025-",countries[i],"-change.pdf"),
path = "results/standard/countries/",device = cairo_pdf,height = 4,width=8)
ggsave(plot,filename = paste0("UNEP-EGR-2025-",countries[i],"-change.svg"),
path = "results/standard/countries/",device = 'svg',height = 4,width=8)
}
## Save data
wb <- createWorkbook()
addWorksheet(wb,"info")
addWorksheet(wb,"data")
info = data.frame(a=c("Author","Contact","Data sources","See also"),
b=c("William F. Lamb",
"william.lamb@pik-potsdam.de",
ref_edgar,ref_lamb))
writeData(wb, sheet = "info",info,colNames = F, rowNames = F)
writeData(wb, sheet = "data",data_countries_change %>%
filter(year %in% c(max(data_countries_change$year),max(data_countries_change$year)-3)) %>%
mutate(units="MtCO2e (GWP100 AR6)") %>%
arrange(iso,country,year,sector_lv2),colNames = T, rowNames = F)
saveWorkbook(wb,paste0("results/standard/countries/UNEP-EGR-2025-country-change.xlsx"),overwrite=T)
